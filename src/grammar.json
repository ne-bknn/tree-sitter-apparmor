{
  "$schema": "https://tree-sitter.github.io/tree-sitter/assets/schemas/grammar.schema.json",
  "name": "apparmor",
  "rules": {
    "source_file": {
      "type": "REPEAT",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SYMBOL",
            "name": "comment_line"
          },
          {
            "type": "SYMBOL",
            "name": "include_line"
          },
          {
            "type": "SYMBOL",
            "name": "abi_line"
          },
          {
            "type": "SYMBOL",
            "name": "tunables_assignment_line"
          },
          {
            "type": "SYMBOL",
            "name": "conditional_var_assignment_line"
          },
          {
            "type": "SYMBOL",
            "name": "alias_line"
          },
          {
            "type": "SYMBOL",
            "name": "file_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "exec_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "alias_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "capability_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "network_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "ptrace_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "signal_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "mount_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "remount_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "userns_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "umount_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "pivot_root_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "dbus_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "unix_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "link_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "change_profile_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "all_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "mqueue_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "io_uring_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "rlimit_rule_line"
          },
          {
            "type": "SYMBOL",
            "name": "file_directive_line"
          },
          {
            "type": "SYMBOL",
            "name": "profile"
          },
          {
            "type": "SYMBOL",
            "name": "newline"
          }
        ]
      }
    },
    "comment_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "comment"
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "include_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "STRING",
                "value": "include"
              },
              {
                "type": "STRING",
                "value": "#include"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": "if"
                  },
                  {
                    "type": "STRING",
                    "value": "exists"
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "FIELD",
            "name": "path",
            "content": {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "angle_path"
                },
                {
                  "type": "SYMBOL",
                  "name": "pathish"
                },
                {
                  "type": "SYMBOL",
                  "name": "include_path"
                }
              ]
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "abi_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "abi"
        },
        {
          "type": "FIELD",
          "name": "path",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "angle_path"
              },
              {
                "type": "SYMBOL",
                "name": "pathish"
              }
            ]
          }
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "tunables_assignment_line": {
      "type": "PREC",
      "value": 3,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "FIELD",
            "name": "var",
            "content": {
              "type": "SYMBOL",
              "name": "tunable_var"
            }
          },
          {
            "type": "FIELD",
            "name": "op",
            "content": {
              "type": "SYMBOL",
              "name": "tunable_op"
            }
          },
          {
            "type": "FIELD",
            "name": "value",
            "content": {
              "type": "SYMBOL",
              "name": "tunable_value"
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "conditional_var_assignment_line": {
      "type": "PREC",
      "value": 3,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "FIELD",
            "name": "var",
            "content": {
              "type": "SYMBOL",
              "name": "conditional_var"
            }
          },
          {
            "type": "PATTERN",
            "value": "\\s*"
          },
          {
            "type": "STRING",
            "value": "="
          },
          {
            "type": "PATTERN",
            "value": "\\s*"
          },
          {
            "type": "FIELD",
            "name": "value",
            "content": {
              "type": "SYMBOL",
              "name": "conditional_value"
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "alias_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "alias"
        },
        {
          "type": "FIELD",
          "name": "source",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "quoted_path"
              },
              {
                "type": "SYMBOL",
                "name": "bare_path"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": "->"
        },
        {
          "type": "FIELD",
          "name": "target",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "quoted_path"
              },
              {
                "type": "SYMBOL",
                "name": "bare_path"
              }
            ]
          }
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "profile": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "profile_header"
            },
            {
              "type": "SYMBOL",
              "name": "profile_header_bare"
            },
            {
              "type": "SYMBOL",
              "name": "profile_header_hat"
            },
            {
              "type": "SYMBOL",
              "name": "profile_header_hat_keyword"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "newline"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "comment_line"
              },
              {
                "type": "SYMBOL",
                "name": "include_line"
              },
              {
                "type": "SYMBOL",
                "name": "abi_line"
              },
              {
                "type": "SYMBOL",
                "name": "capability_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "network_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "file_directive_line"
              },
              {
                "type": "SYMBOL",
                "name": "ptrace_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "signal_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "mount_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "remount_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "userns_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "umount_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "pivot_root_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "dbus_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "unix_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "mqueue_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "io_uring_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "all_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "link_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "change_profile_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "rlimit_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "conditional_rule"
              },
              {
                "type": "SYMBOL",
                "name": "modifier_block"
              },
              {
                "type": "SYMBOL",
                "name": "exec_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "file_rule_line"
              },
              {
                "type": "SYMBOL",
                "name": "profile"
              },
              {
                "type": "SYMBOL",
                "name": "newline"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": "}"
        }
      ]
    },
    "modifier_block": {
      "type": "PREC",
      "value": 3,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "STRING",
                    "value": "owner"
                  },
                  {
                    "type": "STRING",
                    "value": "other"
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "{"
          },
          {
            "type": "SYMBOL",
            "name": "newline"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "comment_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "include_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "file_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "exec_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "capability_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "network_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "dbus_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "unix_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "signal_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "ptrace_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "mount_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "link_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "change_profile_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "file_directive_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "modifier_block"
                },
                {
                  "type": "SYMBOL",
                  "name": "newline"
                }
              ]
            }
          },
          {
            "type": "STRING",
            "value": "}"
          }
        ]
      }
    },
    "profile_header": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "profile"
        },
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "profile_name"
              },
              {
                "type": "SYMBOL",
                "name": "pathish"
              }
            ]
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "REPEAT1",
              "content": {
                "type": "FIELD",
                "name": "attachment",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "xattrs"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "flags"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "{"
        }
      ]
    },
    "profile_header_bare": {
      "type": "SEQ",
      "members": [
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "pathish"
              },
              {
                "type": "SYMBOL",
                "name": "ns_profile_name"
              }
            ]
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "REPEAT1",
              "content": {
                "type": "FIELD",
                "name": "attachment",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "xattrs"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "flags"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "{"
        }
      ]
    },
    "ns_profile_name": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": ":"
          },
          {
            "type": "PATTERN",
            "value": "[^\\s\\{\\r\\n]+"
          }
        ]
      }
    },
    "profile_header_hat": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "^"
        },
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "SYMBOL",
            "name": "profile_name"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "xattrs"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "flags"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "{"
        }
      ]
    },
    "profile_header_hat_keyword": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "hat"
        },
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "SYMBOL",
            "name": "profile_name"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "xattrs"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "flags"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "{"
        }
      ]
    },
    "exec_rule_line": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "priority_prefix"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "FIELD",
              "name": "path",
              "content": {
                "type": "SYMBOL",
                "name": "pathish"
              }
            },
            {
              "type": "FIELD",
              "name": "mode",
              "content": {
                "type": "SYMBOL",
                "name": "exec_mode"
              }
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SEQ",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "->"
                    },
                    {
                      "type": "FIELD",
                      "name": "target",
                      "content": {
                        "type": "SYMBOL",
                        "name": "targetish"
                      }
                    }
                  ]
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "eol"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "priority_prefix"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "unsafe"
                    },
                    {
                      "type": "STRING",
                      "value": "safe"
                    }
                  ]
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "FIELD",
              "name": "mode",
              "content": {
                "type": "SYMBOL",
                "name": "exec_mode"
              }
            },
            {
              "type": "FIELD",
              "name": "path",
              "content": {
                "type": "SYMBOL",
                "name": "pathish"
              }
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SEQ",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "->"
                    },
                    {
                      "type": "FIELD",
                      "name": "target",
                      "content": {
                        "type": "SYMBOL",
                        "name": "targetish"
                      }
                    }
                  ]
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "eol"
            }
          ]
        }
      ]
    },
    "file_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "priority_prefix"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "owner"
                },
                {
                  "type": "STRING",
                  "value": "other"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "FIELD",
                  "name": "path",
                  "content": {
                    "type": "SYMBOL",
                    "name": "pathish"
                  }
                },
                {
                  "type": "FIELD",
                  "name": "perms",
                  "content": {
                    "type": "SYMBOL",
                    "name": "perm_set"
                  }
                }
              ]
            },
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "FIELD",
                  "name": "perms",
                  "content": {
                    "type": "SYMBOL",
                    "name": "perm_set"
                  }
                },
                {
                  "type": "FIELD",
                  "name": "path",
                  "content": {
                    "type": "SYMBOL",
                    "name": "pathish"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "->"
                },
                {
                  "type": "FIELD",
                  "name": "target",
                  "content": {
                    "type": "SYMBOL",
                    "name": "targetish"
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "alias_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "alias"
          },
          {
            "type": "FIELD",
            "name": "rest",
            "content": {
              "type": "SYMBOL",
              "name": "rest_of_line"
            }
          },
          {
            "type": "SYMBOL",
            "name": "newline"
          }
        ]
      }
    },
    "capability_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "capability"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "rest",
                "content": {
                  "type": "SYMBOL",
                  "name": "rest_of_line"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "network_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "network"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "rest",
                "content": {
                  "type": "SYMBOL",
                  "name": "rest_of_line"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "userns_rule_line": {
      "type": "PREC",
      "value": 4,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "userns"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "rest",
                "content": {
                  "type": "SYMBOL",
                  "name": "rest_of_line"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "umount_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "umount"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "fstype="
                },
                {
                  "type": "TOKEN",
                  "content": {
                    "type": "PATTERN",
                    "value": "[^,\\s\\r\\n]+"
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "path",
              "content": {
                "type": "SYMBOL",
                "name": "pathish"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "ptrace_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "ptrace"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "rest",
                "content": {
                  "type": "SYMBOL",
                  "name": "rest_of_line"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "signal_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "signal"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "first",
                "content": {
                  "type": "SYMBOL",
                  "name": "signal_fragment"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "FIELD",
              "name": "cont",
              "content": {
                "type": "SYMBOL",
                "name": "signal_cont_fragment"
              }
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "signal_fragment": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[^\\r\\n]+"
      }
    },
    "signal_cont_fragment": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "newline"
        },
        {
          "type": "PATTERN",
          "value": "[\\t ]+"
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "[^\\r\\n]+"
          }
        }
      ]
    },
    "file_directive_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "priority_prefix"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "rule_modifiers"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "owner"
                      },
                      {
                        "type": "STRING",
                        "value": "other"
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "STRING",
                "value": "file"
              },
              {
                "type": "SYMBOL",
                "name": "eol"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "priority_prefix"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "rule_modifiers"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "owner"
                      },
                      {
                        "type": "STRING",
                        "value": "other"
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "STRING",
                "value": "file"
              },
              {
                "type": "FIELD",
                "name": "perms",
                "content": {
                  "type": "SYMBOL",
                  "name": "perm_set"
                }
              },
              {
                "type": "FIELD",
                "name": "path",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "->"
                      },
                      {
                        "type": "FIELD",
                        "name": "target",
                        "content": {
                          "type": "SYMBOL",
                          "name": "targetish"
                        }
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "SYMBOL",
                "name": "eol"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "priority_prefix"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "rule_modifiers"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "owner"
                      },
                      {
                        "type": "STRING",
                        "value": "other"
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "STRING",
                "value": "file"
              },
              {
                "type": "FIELD",
                "name": "path",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              },
              {
                "type": "FIELD",
                "name": "perms",
                "content": {
                  "type": "SYMBOL",
                  "name": "perm_set"
                }
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "->"
                      },
                      {
                        "type": "FIELD",
                        "name": "target",
                        "content": {
                          "type": "SYMBOL",
                          "name": "targetish"
                        }
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "SYMBOL",
                "name": "eol"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "priority_prefix"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "rule_modifiers"
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "owner"
                      },
                      {
                        "type": "STRING",
                        "value": "other"
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "STRING",
                "value": "file"
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "unsafe"
                      },
                      {
                        "type": "STRING",
                        "value": "safe"
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "FIELD",
                "name": "mode",
                "content": {
                  "type": "SYMBOL",
                  "name": "exec_mode"
                }
              },
              {
                "type": "FIELD",
                "name": "path",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "STRING",
                        "value": "->"
                      },
                      {
                        "type": "FIELD",
                        "name": "target",
                        "content": {
                          "type": "SYMBOL",
                          "name": "targetish"
                        }
                      }
                    ]
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "SYMBOL",
                "name": "eol"
              }
            ]
          }
        ]
      }
    },
    "mount_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "mount"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "rest",
                "content": {
                  "type": "SYMBOL",
                  "name": "rest_of_line"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "remount_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "remount"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "options="
                },
                {
                  "type": "STRING",
                  "value": "("
                },
                {
                  "type": "TOKEN",
                  "content": {
                    "type": "PATTERN",
                    "value": "[^)\\r\\n]*"
                  }
                },
                {
                  "type": "STRING",
                  "value": ")"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "path",
              "content": {
                "type": "SYMBOL",
                "name": "pathish"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "mqueue_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "mqueue"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "rest",
              "content": {
                "type": "SYMBOL",
                "name": "rest_of_line"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "io_uring_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "io_uring"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "rest",
              "content": {
                "type": "SYMBOL",
                "name": "rest_of_line"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "dbus_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "dbus"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "first",
              "content": {
                "type": "SYMBOL",
                "name": "dbus_fragment"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "FIELD",
            "name": "cont",
            "content": {
              "type": "SYMBOL",
              "name": "dbus_cont_fragment"
            }
          }
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "unix_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "unix"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "first",
                "content": {
                  "type": "SYMBOL",
                  "name": "unix_fragment"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "FIELD",
              "name": "cont",
              "content": {
                "type": "SYMBOL",
                "name": "unix_cont_fragment"
              }
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "all_rule_line": {
      "type": "PREC",
      "value": 4,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "all"
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "link_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "priority_prefix"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "STRING",
                    "value": "owner"
                  },
                  {
                    "type": "STRING",
                    "value": "other"
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "link"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "STRING",
                "value": "subset"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "FIELD",
            "name": "source",
            "content": {
              "type": "SYMBOL",
              "name": "pathish"
            }
          },
          {
            "type": "STRING",
            "value": "->"
          },
          {
            "type": "FIELD",
            "name": "target",
            "content": {
              "type": "SYMBOL",
              "name": "pathish"
            }
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "change_profile_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_modifiers"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "STRING",
            "value": "change_profile"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "STRING",
                    "value": "unsafe"
                  },
                  {
                    "type": "STRING",
                    "value": "safe"
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "exec_mode"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "exec",
                "content": {
                  "type": "SYMBOL",
                  "name": "pathish"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": "->"
                  },
                  {
                    "type": "FIELD",
                    "name": "target",
                    "content": {
                      "type": "SYMBOL",
                      "name": "targetish"
                    }
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "rlimit_rule_line": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "set"
          },
          {
            "type": "STRING",
            "value": "rlimit"
          },
          {
            "type": "FIELD",
            "name": "limit",
            "content": {
              "type": "SYMBOL",
              "name": "rlimit_name"
            }
          },
          {
            "type": "STRING",
            "value": "<="
          },
          {
            "type": "FIELD",
            "name": "value",
            "content": {
              "type": "SYMBOL",
              "name": "rlimit_value"
            }
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "FIELD",
                "name": "unit",
                "content": {
                  "type": "SYMBOL",
                  "name": "rlimit_unit"
                }
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "eol"
          }
        ]
      }
    },
    "rlimit_name": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[a-z_]+"
      }
    },
    "rlimit_value": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "-?[0-9]+|infinity"
      }
    },
    "rlimit_unit": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[A-Za-z]+"
      }
    },
    "conditional_rule": {
      "type": "PREC",
      "value": 3,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "if"
          },
          {
            "type": "FIELD",
            "name": "condition",
            "content": {
              "type": "SYMBOL",
              "name": "cond_expr"
            }
          },
          {
            "type": "STRING",
            "value": "{"
          },
          {
            "type": "SYMBOL",
            "name": "newline"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "comment_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "include_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "file_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "exec_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "capability_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "network_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "dbus_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "unix_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "signal_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "ptrace_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "mount_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "remount_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "umount_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "pivot_root_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "userns_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "mqueue_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "io_uring_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "link_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "change_profile_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "all_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "rlimit_rule_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "file_directive_line"
                },
                {
                  "type": "SYMBOL",
                  "name": "conditional_rule"
                },
                {
                  "type": "SYMBOL",
                  "name": "profile"
                },
                {
                  "type": "SYMBOL",
                  "name": "newline"
                }
              ]
            }
          },
          {
            "type": "STRING",
            "value": "}"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": "else"
                  },
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "conditional_rule"
                      },
                      {
                        "type": "SEQ",
                        "members": [
                          {
                            "type": "STRING",
                            "value": "{"
                          },
                          {
                            "type": "SYMBOL",
                            "name": "newline"
                          },
                          {
                            "type": "REPEAT",
                            "content": {
                              "type": "CHOICE",
                              "members": [
                                {
                                  "type": "SYMBOL",
                                  "name": "comment_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "include_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "file_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "exec_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "capability_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "network_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "dbus_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "unix_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "signal_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "ptrace_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "mount_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "remount_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "umount_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "pivot_root_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "userns_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "mqueue_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "io_uring_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "link_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "change_profile_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "all_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "rlimit_rule_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "file_directive_line"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "conditional_rule"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "profile"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "newline"
                                }
                              ]
                            }
                          },
                          {
                            "type": "STRING",
                            "value": "}"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          }
        ]
      }
    },
    "cond_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "REPEAT",
          "content": {
            "type": "STRING",
            "value": "not"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "defined"
                },
                {
                  "type": "SYMBOL",
                  "name": "cond_var"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "cond_bool_var"
            }
          ]
        }
      ]
    },
    "cond_var": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "@"
          },
          {
            "type": "PATTERN",
            "value": "[A-Za-z_][A-Za-z0-9_]*"
          }
        ]
      }
    },
    "cond_bool_var": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "$"
              },
              {
                "type": "PATTERN",
                "value": "[A-Za-z_][A-Za-z0-9_]*"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "${"
              },
              {
                "type": "PATTERN",
                "value": "[A-Za-z_][A-Za-z0-9_]*"
              },
              {
                "type": "STRING",
                "value": "}"
              }
            ]
          }
        ]
      }
    },
    "exec_mode": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "r?(?:ix|[pPcCuU]x|[pPcC][iIuU]x)"
      }
    },
    "comment": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "#"
          },
          {
            "type": "PATTERN",
            "value": "[^\\r\\n]*"
          }
        ]
      }
    },
    "angle_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "<"
          },
          {
            "type": "PATTERN",
            "value": "[^>\\r\\n]+"
          },
          {
            "type": "STRING",
            "value": ">"
          }
        ]
      }
    },
    "quoted_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "\""
          },
          {
            "type": "PATTERN",
            "value": "[^\"\\r\\n]+"
          },
          {
            "type": "STRING",
            "value": "\""
          }
        ]
      }
    },
    "include_path": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[A-Za-z0-9_.][A-Za-z0-9_.\\-]*\\/[^\\s\\r\\n,]*"
      }
    },
    "bare_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "STRING",
                "value": "/"
              },
              {
                "type": "STRING",
                "value": "~"
              }
            ]
          },
          {
            "type": "PATTERN",
            "value": "([^\\s\\r\\n]|\\{[^}]*\\}|\\\\ )*"
          }
        ]
      }
    },
    "var_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "@{"
          },
          {
            "type": "PATTERN",
            "value": "[^}\\r\\n]+"
          },
          {
            "type": "STRING",
            "value": "}"
          },
          {
            "type": "PATTERN",
            "value": "[^\\s\\r\\n+=]"
          },
          {
            "type": "PATTERN",
            "value": "[^\\s\\r\\n]*"
          }
        ]
      }
    },
    "newline": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "\\r?\\n"
      }
    },
    "profile_name": {
      "type": "PATTERN",
      "value": "([^\\s\\{\\r\\n]|@\\{[^}]+\\})+"
    },
    "xattrs": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "xattrs"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "="
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "xattr_entry"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "STRING",
                    "value": ","
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "SYMBOL",
                "name": "xattr_entry"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "xattr_entry": {
      "type": "SEQ",
      "members": [
        {
          "type": "FIELD",
          "name": "key",
          "content": {
            "type": "TOKEN",
            "content": {
              "type": "PATTERN",
              "value": "[A-Za-z0-9_.+\\-]+"
            }
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "="
                },
                {
                  "type": "FIELD",
                  "name": "value",
                  "content": {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "quoted_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_bare_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_var_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "tunable_var"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_value"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "flags": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "flags"
                },
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "="
                    },
                    {
                      "type": "BLANK"
                    }
                  ]
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "flag_entry"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "STRING",
                    "value": ","
                  },
                  {
                    "type": "BLANK"
                  }
                ]
              },
              {
                "type": "SYMBOL",
                "name": "flag_entry"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "flag_entry": {
      "type": "SEQ",
      "members": [
        {
          "type": "FIELD",
          "name": "key",
          "content": {
            "type": "TOKEN",
            "content": {
              "type": "PATTERN",
              "value": "[A-Za-z0-9_.+\\-]+"
            }
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "="
                },
                {
                  "type": "FIELD",
                  "name": "value",
                  "content": {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "quoted_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_bare_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_var_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "tunable_var"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "flags_value"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "flags_value": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[A-Za-z0-9_.+\\-]+"
      }
    },
    "flags_bare_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "STRING",
                "value": "/"
              },
              {
                "type": "STRING",
                "value": "~"
              }
            ]
          },
          {
            "type": "PATTERN",
            "value": "([^\\s\\r\\n)]|\\{[^}]*\\})*"
          }
        ]
      }
    },
    "flags_var_path": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "@{"
          },
          {
            "type": "PATTERN",
            "value": "[^}\\r\\n]+"
          },
          {
            "type": "STRING",
            "value": "}"
          },
          {
            "type": "PATTERN",
            "value": "[^\\s\\r\\n+=)]"
          },
          {
            "type": "PATTERN",
            "value": "[^\\s\\r\\n)]*"
          }
        ]
      }
    },
    "rest_of_line": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[^\\r\\n,].*"
      }
    },
    "dbus_fragment": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[^\\r\\n]+"
      }
    },
    "dbus_cont_fragment": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "newline"
        },
        {
          "type": "PATTERN",
          "value": "[\\t ]+"
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "[^\\r\\n]+"
          }
        }
      ]
    },
    "unix_fragment": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[^\\r\\n]+"
      }
    },
    "unix_cont_fragment": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "newline"
        },
        {
          "type": "PATTERN",
          "value": "[\\t ]+"
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "[^\\r\\n]+"
          }
        }
      ]
    },
    "identifier_with_vars": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "(?:[^\\s,\\r\\n]|@\\{[^}\\r\\n]+\\})+"
      }
    },
    "rule_modifiers": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "audit"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "allow"
                    },
                    {
                      "type": "STRING",
                      "value": "deny"
                    },
                    {
                      "type": "STRING",
                      "value": "prompt"
                    }
                  ]
                },
                {
                  "type": "BLANK"
                }
              ]
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "allow"
            },
            {
              "type": "STRING",
              "value": "deny"
            },
            {
              "type": "STRING",
              "value": "prompt"
            }
          ]
        }
      ]
    },
    "perm_set": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[rwalkixmRWALKIXMpPcCuU]+"
      }
    },
    "priority_prefix": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "priority"
        },
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "[+-]?\\d+"
          }
        },
        {
          "type": "PATTERN",
          "value": "\\s+"
        }
      ]
    },
    "pivot_root_rule_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "rule_modifiers"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "pivot_root"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": "oldroot="
                },
                {
                  "type": "FIELD",
                  "name": "oldroot",
                  "content": {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "quoted_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "bare_path"
                      },
                      {
                        "type": "SYMBOL",
                        "name": "var_path"
                      }
                    ]
                  }
                },
                {
                  "type": "PATTERN",
                  "value": "\\s+"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "path",
              "content": {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "quoted_path"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "bare_path"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "var_path"
                  }
                ]
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "eol"
        }
      ]
    },
    "tunable_var": {
      "type": "TOKEN",
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "@{"
          },
          {
            "type": "PATTERN",
            "value": "[A-Za-z][A-Za-z0-9_]*"
          },
          {
            "type": "STRING",
            "value": "}"
          }
        ]
      }
    },
    "tunable_op": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "STRING",
            "value": "+="
          },
          {
            "type": "STRING",
            "value": "="
          }
        ]
      }
    },
    "tunable_value": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[\\S].*"
      }
    },
    "conditional_var": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "$"
              },
              {
                "type": "PATTERN",
                "value": "[A-Za-z_][A-Za-z0-9_]*"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "${"
              },
              {
                "type": "PATTERN",
                "value": "[A-Za-z_][A-Za-z0-9_]*"
              },
              {
                "type": "STRING",
                "value": "}"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "@"
              },
              {
                "type": "PATTERN",
                "value": "[A-Za-z_][A-Za-z0-9_]*"
              }
            ]
          }
        ]
      }
    },
    "conditional_value": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "\""
              },
              {
                "type": "PATTERN",
                "value": "[^\"\\r\\n]*"
              },
              {
                "type": "STRING",
                "value": "\""
              }
            ]
          },
          {
            "type": "PATTERN",
            "value": "[tT][rR][uU][eE]"
          },
          {
            "type": "PATTERN",
            "value": "[fF][aA][lL][sS][eE]"
          }
        ]
      }
    },
    "pathish": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "quoted_path"
        },
        {
          "type": "SYMBOL",
          "name": "bare_path"
        },
        {
          "type": "SYMBOL",
          "name": "var_path"
        },
        {
          "type": "SYMBOL",
          "name": "tunable_var"
        }
      ]
    },
    "targetish": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "pathish"
        },
        {
          "type": "SYMBOL",
          "name": "profile_name"
        },
        {
          "type": "SYMBOL",
          "name": "identifier_with_vars"
        }
      ]
    },
    "eol": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "comment"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "newline"
        }
      ]
    }
  },
  "extras": [
    {
      "type": "PATTERN",
      "value": "\\t|[ ]"
    },
    {
      "type": "SYMBOL",
      "name": "comment"
    }
  ],
  "conflicts": [],
  "precedences": [],
  "externals": [],
  "inline": [],
  "supertypes": [],
  "reserved": {}
}